---
title: "Биостатистика ДЗ 1"
output: html_document
date: "2025-04-13"
---
загружаю датасет pima
```{r}
library(readxl)
file_path <- "pima.xlsx"

# Чтение данных из первого листа pima
data <- read_excel(file_path, sheet = "pima")   #  Чтение по имени
head(data)  
```
1. Рассчитайте число наблюдений, среднее, стандартное отклонение, 1-й и 3-й квартили, минимум и максимум для переменных glucose, pressure, mass.

```{r}
library(dplyr)

# Перечень переменных
variables <- c("glucose", "pressure", "mass")

# Используем summarise() для расчета статистики
results <- data %>%
  select(all_of(variables)) %>% # Выбираем только нужные переменные
  summarise(
    across(
      .cols = everything(),  # Применяем ко всем выбранным столбцам
      .fns = list(
        Observations = ~length(.),  # Число наблюдений
        Mean = ~mean(.),              # Среднее
        SD = ~sd(.),                  # Стандартное отклонение
        Q1 = ~quantile(., 0.25),      # 1-й квартиль
        Q3 = ~quantile(., 0.75),      # 3-й квартиль
        Min = ~min(.),                # Минимум
        Max = ~max(.)                 # Максимум
      )
    )
  )

# Вывод результатов
print(results)
```
2. Рассчитайте описательную статистику для переменной diabetes.
```{r}
#Рассчитываем частоты для переменной diabetes, она является категориальной переменной, поэтому среднее, стандартное отклонение и другое мы посчитате не можем, но можем посчитать сколько того или иного показателя в этой переменной присутствует
diabetes_counts <- table(data$diabetes)

# Рассчитываем процентное соотношение
diabetes_proportions <- prop.table(diabetes_counts) * 100

# Вывод результатов
print("Частоты для переменной diabetes:")
print(diabetes_counts)

print("\nПроцентное соотношение:")
print(diabetes_proportions)
```

 Создайте на основе переменной age новую переменную age_group, которая будет отражать следующие возрастные группы: 21–35, 36–49 и 50+. Посчитайте описательную статистику для новой переменной

```{r}
# НОвая переменная age_group
data$age_group <- ifelse(data$age >= 21 & data$age <= 35, "21-35",
                         ifelse(data$age >= 36 & data$age <= 49, "36-49",
                                "50+"))

# Преобразование age_group в фактор для удобства дальнейшей работы
data$age_group <- factor(data$age_group, levels = c("21-35", "36-49", "50+"))

#считаем описательную статистику
age_group_counts <- table(data$age_group)

# Рассчитываем процентное соотношение
age_group_proportions <- prop.table(age_group_counts) * 100

# Вывод результатов
print("Частоты для переменной age_group:")
print(age_group_counts)

print("\nПроцентное соотношение:")
print(age_group_proportions)
```
3. Постройте два ящика с усами для значений pos и neg соответственно переменной diabetes
```{r}
boxplot(glucose ~ diabetes,  
        data = data,            
        xlab = "Diabetes (0 = No, 1 = Yes)",  
        main = "Glucose Level by Diabetes Status",  
        col = c("lightblue", "lightgreen"))     
```
4. Проводят некоторое исследование пациентов с артериальной гипертензией. Предположим, что внедрение нового препарата в среднем лучше снижает их давление по сравнению со стандартной терапией.

Задайте seed для воспроизводимости результатов (функция set.seed()). Задайте размер выборки sample_size <- 30. Задайте значение среднего систолического артериального давления до приема нового препарата и после.
```{r}
# 1. Задаем seed для воспроизводимости
set.seed(123)

# 2. размер выборки
sample_size <- 30

# 3. Задаем параметры для моделирования данных
mean_before <- 140  # Среднее систолическое АД до приема препарата
mean_after <- 125   # Среднее систолическое АД после приема препарата
sd <- 15            # Предполагаемое стандартное отклонение (общее для обеих групп)

# 4. 1 - выборка до приема препарата, и 2- после приема препарата. Берем нормальное распределение т.к значение артериального давления можно отнести к данным с нормальным распределением
group_before <- rnorm(sample_size, mean = mean_before, sd = sd)
group_after <- rnorm(sample_size, mean = mean_after, sd = sd)

```
4.1 Сформулируйте нулевую и альтернативную гипотезы: 
Нулевая гипотеза (H0): Новый препарат не снижает артериальное давление лучше, чем стандартная терапия 
Альтернативная гипотеза (H1): Новый препарат снижает артериальное давление лучше, чем стандартная терапия.
4.2 Определите уровень значимости: стандартный уровень значимости обычно берется 0.05, в нашем случае это alpha

```{r}
alpha <- 0.05 
```

4.3 Выберите и примените статистический тест для проверки гипотезы и аргументируйте свой выбор: Мы используем парный t-тест (paired t-test), это вариант t-критерия Стьюдента, потому что:
- У нас есть парные данные:  давление одного и того же пациента до и после приема препарата.
- Мы предполагаем, что данные распределены нормально.
- Мы хотим сравнить средние значения двух связанных выборок.
- Нас интересует односторонний тест (снижение давления).

```{r}

paired_test <- t.test(group_before, group_after, paired = TRUE, alternative = "greater")

print(paired_test)
```
4.4 Оцените и прокомментируйте статистическую значимость: чтобы оценить полученные данные мы смотрим на p-value - Если p-value меньше, чем уровень значимости (alpha), мы отвергаем нулевую гипотезу. Наш p-value = 0.002346,это меньше чем 0,05, значит мы отвергаем нулевую гипотизу и говорим, что препарат работает и снижает артериальное давление луче чем изначальный
```{r}

if (paired_test$p.value < alpha) {
  print("Отвергаем нулевую гипотезу: Новый препарат статистически значимо снижает артериальное давление лучше, чем стандартная терапия.")
} else {
  print("Недостаточно оснований для отклонения нулевой гипотезы: Нет статистически значимых доказательств, что новый препарат снижает артериальное давление лучше, чем стандартная терапия.")
}

```

